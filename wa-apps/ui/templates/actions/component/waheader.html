{$_title = "Меню приложений"}
{$wa->title($_title)}

<div class="u-component-page">

    <h1>Меню <code>{literal}{$wa->header()}{/literal}</code></h1>

    <p class="large">Фирменный знак Webasyst — верхнее меню навигации с иконками приложений — сохранился и был серьезно улучшен. Появился новый режим <code>'custom'</code>.</p>

    <h3>Всегда наверху: <code>top: 0; height: 4rem;</code></h3>
    <p>Особенность <code>$wa->header()</code> в Webasyst 2 — он всегда находится на самом верху экрана (<code>position: fixed; <strong>top: 0;</strong> left: 0; right: 0;</code>) и имеет высоту = <code>height: <strong>4rem</strong></code>.</p>
    <p>Выше <code>$wa->header()</code> в Webasyst 2, в отличие от Webasyst 1.x, не может быть ничего. Ниже и даже поверх — без проблем. Но не выше. Такое ограничение и жесткость геометрии <code>$wa->header()</code> введены по двум основным причинам. Во-первых, для целостности восприятия интерфейса пользователем. Логотип аккаунта показывается всегда в верхнем левом углу экрана и никак иначе (как кнопка Esc на клавиатуре). Во-вторых, для предсказуемости поведения внешней обвязки для разработчиков сторонних приложений. Разработчик гипотетического «Супер-пупер-склада» для Webasyst должен быть уверен, что никакие баннеры, анонсы или уведомления с рекламой Shop-Script или Pocket Lists не будут показаны в интерфейсе его приложения.</p>

    <p>Все агитационные баннеры и призывы можно размещать либо в виде анонса (<code>wa_announcement</code>) в дашборде и «под колокольчиком» или же с индивидуальным дизайном в интерфейсе своего приложения ниже <code>$wa->header()</code> с использованием CSS-класса <a href="{$wa_app_url}component/banner/">.banner</a>.</p>

    <h3><code>#wa</code> &gt; <code>#wa-header</code> + <code>#wa-app</code></h3>

    <p>Типовая структура шаблона приложения в wa-2.0 практически не изменилась по сравнению с wa-1.3 и по-прежнему основана на <code>#wa</code>, <code>#wa-header</code> и <code>#wa-app</code>. Так же, как и в wa-1.3, <em>приложение самостоятельно рисует</em> полную страницу от <code>&lt;html&gt;</code> до <code>&lt;/html&gt;</code> и, следовательно, в своих шаблонах вызывает хелпер отрисовки меню навигации приложения — <code>&#123;$wa->header()&#125;</code>.</p>

    <p>Единственное важное отличие — теперь <code>#wa-header</code> имеет более общую обертку <code>#wa-nav</code> в связи с расширением возможностей навигации в бекенде.</p>

    <pre class="prettyprint">
&lt;body&gt;
    &lt;div id="<b>wa</b>"&gt;

        <b>&#123;$wa->header()&#125;</b>

        &lt;div id="<b>wa-app</b>"&gt;

            &lt;!-- YOUR APP HERE --&gt;
            &lt;div class="flexbox"&gt;
                &lt;div class="sidebar"&gt;
                    <em>app navigation</em>
                &lt;/div&gt;
                &lt;div class="content"&gt;
                    <em>app content</em>
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;!-- /YOUR APP HERE --&gt;

        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;</pre>

    <h3>{literal}{$wa->header(<code>'custom'</code>)}{/literal}</h3>

    <p><em><b class="highlighted">ВНИМАНИЕ:</b> поддержка режима <em>'custom'</em> появится на этапах 2.0—2.Х <a href="{$wa_app_url}component/migrate/">общего плана</a> выпуска интерфейса Webasyst 2.</em></p>

    <p>В связи с подготовкой платформы Webasyst 2 к появлению больших приложений X, роль верхнего меню переходит на следующий — более гибкий — уровень.</p>

    <p>В некоторых особых случаях, когда разработчику приложения нужно «приглушить» базовую возможность Вебасиста работать с разными приложениями, разработчик может <em>в рамках своего приложения</em> использовать вариант навигации, скрывающий иконки других приложений в <code>$wa->header()</code>, получив тем самым дополнительное пространство для реализации навигации внутри приложения. Для этого достаточно заменить вызов навигации на {literal}<code>{$wa->header('custom', $my_custom_content, $overlay_wa_apps = true)}</code>{/literal}:</p>

    <ul class="separated">
        <li><code>'custom'</code>: параметр указывает на режим, в котором меню приложений будет заменено другим содержимым (в будущем возможно появление дополнительных вариантов, поэтому выделение 'custom' сделано в формате строки, а не просто boolean).</li>
        <li><code>$my_custom_content</code>: новое HTML/CSS/JS-содержимое в основной области <code>$wa->header()</code>.</li>
        <li><code>$overlay_wa_apps = true</code>: если true, то меню приложений останется в DOM, а содержимое <code>$my_content</code> будет показано в пустом <code>div</code> поверх этого меню, визуально полностью перекрывая его. Это позволит в случае необходимости (например, при прокручивании или по нажатию на какую-то кнопку) с помощью JavaScript скрыть этот <code>div</code> и отобразить меню приложений. Если же значение параметра — false, то меню приложений не будет добавлено в DOM.</li>
    </ul>

    <p>Использование такого режима рекомендуется только в особых случаях, когда внимание пользователей следует сосредоточить на данном единственном приложении вместо удобной работы сразу с несколькими. Например, когда это брендированный сервис Х, состоящий из единственного приложения, а все сопутствующие приложения («Команда», «Сайт», «Настройки» и т. д.) являются неактуальными или даже отсутствуют.</p>

    <p>В 'custom'-варианте <code>$wa->header()</code> остаются только пользовательский логотип в левом верхнем углу и иконка текущего пользователя — в правом. Все остальное пространство становится доступным разработчику.</p>

    <p>Как заполнить это свободное пространство и как организовать взаимосвязь с любыми системными приложениями Webasyst, включая «Настройки», «Инсталлер», «Сайт», «Команду» (например, управление правами доступа) — в 'custom'-режиме <code>$wa->header()</code> остается исключительно на усмотрение разработчика приложения.</p>

    <p>Таким образом, поведение <code>$wa->header()</code> внутри приложения — в руках разработчика приложения. Пользователь никакими глобальными системным настройками и преференциями Webasyst не сможет регулировать это поведение.</p>

    <blockquote class="highlighted green"><b>РЕКОМЕНДАЦИЯ:</b> разработчикам, распространяющим свои продукты в «Инсталлере», следует избегать режима 'custom' или же применять его с крайней осторожностью, так как он затрудняет переключение между приложениями и мешает продаже дополнительных приложений, в том числе собственного производства. Эффективнее использовать классический вариант <code>$wa->header()</code>, «на лету» меняя его содержимое в зависимости от контекста выполняемого действия.</blockquote>

    <h3>Замена $wa->header() на лету (JS)</h3>

    <p>Во многих случаях будет полезно менять содержимое <code>$wa->header()</code> в зависимости от контекста внутри приложения и скрывать или, наоборот, показывать меню приложений только тогда, когда это действительно полезно для пользователя.</p>
    <p>В качестве примера можно посмотреть приложение «Блог», в котором иконки приложений пропадают из меню в режиме редактирования. Или же дашборд, в котором меню приложений по умолчанию отсутствует, но становится видимым при прокручивании страницы вглубь ленты событий (<code>wa_log</code>).

    <hr>

    <h3>Полный отказ от $wa->header()</h3>
    <p>У разработчика есть техническая возможность полного отказа от использования <code>$wa->header()</code> в своем приложении. Такое поведение легально и действительно может быть оправданно при разработке собственных независимых AaaS-сервисов (App as a Service) на основе фреймворка Webasyst.</p>
    <p>Требование наличия <code>$wa->header()</code> в приложении действительно только в случае распространения приложения через экосистему Webasyst и «Инсталлер». В этом случае обязательно использование либо базового вида <code>$wa->header()</code>, либо собственного варианта — <code>$wa->header('custom')</code>. Наличие <code>$wa->header()</code> в этом случае необходимо для обеспечения связности приложения с другими установленными приложениями и целостного опыта работы пользвателя с Webasyst как с платформой, обеспечивающей функциональное единство разных приложений.</p>

    <script>
        $.wa_ui.title.set({$_title|json_encode});

        if (typeof prettyPrint != 'undefined' && $.isFunction(prettyPrint)) {
            prettyPrint();
        }
    </script>
</div>
